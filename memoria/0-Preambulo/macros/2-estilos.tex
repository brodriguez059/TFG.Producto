% ################################################################
% #######     ESTILOS EN GENERAL                    ##############
% ################################################################

% *********************** Cabeceras ******************************

% ************ Headers, Footnotes and others ************
\fancyheadoffset{0pt} % Used to extend the headrule and footrule, don't know why it works

% % De las cabeceras y pies de página de cada página:
\fancypagestyle{empty}{ %
    \fancyhf{} % remove everything
    \renewcommand{\headrulewidth}{0pt} % remove lines as well
    \renewcommand{\footrulewidth}{0pt}
}

% Redefine plain page style
\fancypagestyle{plain}{
	\fancyhf{}
	\renewcommand{\headrulewidth}{0pt}
	\fancyfoot[LO,RE]{\thepage}
}

\fancypagestyle{fancy-intro}{%
    \fancyhf{}
    \fancyhead[LO]{\textit{\nouppercase{\rightmark}}}
    \fancyhead[RE]{\textit{\nouppercase{\leftmark}}}
    \fancyfoot[RE,LO]{\thepage}
    \renewcommand{\headrulewidth}{1pt}
    \renewcommand{\footrulewidth}{1pt}
}

\fancypagestyle{fancy-body}{%
    \fancyhf{}
    \fancyhead[LO]{\nouppercase{\rightmark}}
    \fancyhead[RE]{\nouppercase{\leftmark}}
    \fancyfoot[RE,LO]{\thepage}
    \renewcommand{\headrulewidth}{1pt}
    \renewcommand{\footrulewidth}{1pt}
}

\fancypagestyle{fancy-end}{%
    \fancyhf{}
    \fancyhead[RO]{\leftmark}
    \fancyhead[LE]{\emph{Anexo \thechapter}}
    \fancyfoot[RE,LO]{\thepage}
    \renewcommand{\headrulewidth}{1pt}
    \renewcommand{\footrulewidth}{1pt}
}

% Code for creating empty pages
% No headers on empty pages before new chapter
% this next section (till \makeatother) makes sure that blank pages
%% are actually completely blank, cause they're not usually
\makeatletter % Necesario para hacer que @ tenga el significado adecuado
\def\cleardoublepage%
{
\clearpage
\if@twoside%
    \ifodd%
        \c@page%
    \else
        \hbox{}
        \vspace*{\fill}
        \thispagestyle{empty}
        \newpage
        \if@twocolumn%
            \hbox{}
            \newpage
        \fi
    \fi
\fi
}
\makeatother  % Restauramos el valor de @ anterior a este if

% Determina el estilo de \rightmark y \leftmark:
\renewcommand{\chaptermark}[1]{\markboth{Capítulo \thechapter:\ #1}{Capítulo
\thechapter:\ #1}}
% Determina el estilo de \rightmark
\renewcommand{\sectionmark}[1]{\markright{Sección \thesection:\ #1}}

% ************ Sectioning ************

% Del estilo de los apartados seccionadores (capítulos, secciones, ...):
\renewcommand{\thepart}{\arabic{part}}
\titleformat%
    {\part} % command (depth=-1)
    [display]  % shape
    {\bfseries\Large} % format
    {\filcenter\Huge\MakeUppercase{\partname} \Huge\thepart} % label
    {4ex}
    {%marra
        \vspace{2ex}%
        \filcenter\huge\filright%
    } % before-code
    [
        \vspace{2ex}%
    ] % after-code

\titleformat%
    {\chapter} % command (depth=0)
    [display] % shape
    {\bfseries\Large}
    {
        \filleft\Large\MakeUppercase{\chaptertitlename}\Large\thechapter%
    } % label
    {2ex} % sep
    {
        \titlerule%
    	\vspace{1ex}%
    	\filright%
	} % before-code
    [
        \vspace{2ex}%
        \titlerule%
    ] % after-code

\titleformat%
    {\section} % command (depth=1)
    [hang] % shape
    {\normalfont\bfseries} % format
    {\thesection.} % label
    {0em} % sep
    {
    } % before-code
    [
    ] % after-code

\titleformat%
    {\subsection} % command (depth=2)
    [hang] % shape
    {\normalfont\bfseries} % format
    {\thesubsection.} % label
    {0em} % sep
    {
    } % before-code
    [
    ] % after-code

\titleformat%
    {\subsubsection} % command (depth=3)
    [hang] % shape
    {\normalfont\bfseries} % format
    {\thesubsubsection.} % label
    {0em} % sep
    {
    } % before-code
    [
    ] % after-code

\titleformat%
    {\paragraph} % command (depth=4)
    [hang] % shape
    {\normalfont\bfseries} % format
    {} % label
    {0em} % sep
    {
    } % before-code
    [
    ] % after-code

\titleformat%
    {\subparagraph} % command (depth=5)
    [runin] % shape
    {\normalfont\bfseries} % format
    {} % label
    {0em} % sep
    {
    } % before-code
    [
    ] % after-code

% Controlamos el espaciado entre secciones
% \titlespacing*{\part}
% {0pt}{0pt}{0pt}

% \titlespacing*{\chapter}
% {0pt}{0pt}{0pt}

\titlespacing*{\section}
{0pt}{2ex}{0pt}
% {0pt}{5.5ex plus 1ex minus .2ex}{4.3ex plus .2ex}
\titlespacing*{\subsection}
{0pt}{2ex}{0pt}
% {0pt}{5.5ex plus 1ex minus .2ex}{4.3ex plus .2ex}
\titlespacing*{\subsubsection}
{0pt}{2ex}{0pt}

\titlespacing*{\paragraph}
{0pt}{0pt}{0pt}

\titlespacing*{\subparagraph}
{0pt}{0pt}{0pt}

% *********************** Global paragraph indentation and line spacing/strech ******************************
\frenchspacing % To treat all spaces equally
\widowpenalty=1000 %
\raggedbottom% Cambia el espaciado del contenido de las páginas (sin esto las listas se expanden para ocupar toda la página)

% \setlength{\parskip}{1.5ex plus 0.5ex minus 0.5ex}   % establece separacion entre parrafos a 8 puntos

% Control de interlineado
% \setlength{\lineskip}{1pt}
% \singlespacing
% \onehalfspacing
% \doublespacing
% \setstretch{1.1}
% \linespread{1.0}

% ************************* ToC and Index ********************************
\setcounter{secnumdepth}{3} % Máx. numerated depth %% which sections are numbered
\setcounter{tocdepth}{2} % Máx. depth that appears in ToC. Titles level degree at table of contents